<?php
	require_once 'db.php';
?>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>File Upload Vulnerabilities</title>
<link rel="stylesheet" href="css/bootstrap.min.css">
<link rel="stylesheet" href="css/bootstrap-rtl.min.css">
<link rel="stylesheet" href="css/font-awesome.min.css">
<link rel="stylesheet" href="css/style.css">
<style>
input{
	font-family:arial;
}
</style>
</head>
<body>
	<div class="container">

	<?php require_once 'template/header.php'; ?>
		<div class="body text-center">
			 <br>
			 <?php
				if(isset($_POST['btn_upload']))
				{
					//ali.php
					//dadada.tmp
					$name = strtolower($_FILES['image']['name']);
					$extensions = explode('.',$name);
					$tmp_name = $_FILES['image']['tmp_name'];
					$type = $_FILES['image']['type'];
					$blackList = array('php','html','phtml');
					if(!in_array(end($extensions),$blackList))
					{
						if($type == 'image/png')
						{
							$move = move_uploaded_file($tmp_name,"upload/$name");
							print "Ok Upload!";
						}
						else
							print 'Mime Type File Error!';
					}
					else
						print "forbidden extensions !";
				}
			 ?>
			 <br>
		 <form action="" dir="ltr" method="post" enctype="multipart/form-data">
			 <input type="file" name="image" class="form-control">
			 <br>
			 <input type="submit" name="btn_upload" class="btn btn-success" value="Upload">
		 </form>		
		</div>
	</div>
</body>
</html>
